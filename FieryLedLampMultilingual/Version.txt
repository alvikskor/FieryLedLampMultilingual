
Поточна версія / Current version : v3.8_sound_Multilingual_IR 112 ефектов


ИСТОРИЯ ВЕРСИЙ:
Версия v3.8_sound_Multilingual_IR 112 ефектов
 - Додано налаштування MQTT у веб-інтерфейсі. Налаштовуєтся IP адреса або URL брокера (приклад: 192.168.1.99   або   test.mosquitto.org), порт, ім'я та пароль для доступу на сервер брокера.
 Писля налаштування потрібно натиснути кнопку "Зберігти" та перезавантажити лампу для застосування зроблених змін. Також є галочка для тимчасового припинення обміну публікаціями з брокером 
 (коли галочка стоїть - обмін працює (зміна відбувається без кнопки "Зберігти")). Щоб включити до проекту код обробки MQTT в файлs constants.h в рядку #define USE_MQTT повино бути (true).
 - Додано пидтримку ESP32. Для використання обох плат (ESP32 або ESP8266) в коді не потрібно нічого змінювати. Просто в Arduino IDE виберіть відповідну плату (для ESP32 - "ESP32 Dev Module").
 Перевірялась робота на ядрі ESP32 версій 1.0.6 та 2.0.14. Для використання ядра 1.0.6 закоментуйте відповідну строку у головному файлі проекту (дивись коменти в коді). Перевірялась робота
 на модули ESP32-WROOM-32D. Робота на ESP32S2, ESP32S3, ESP32C2 не перевірялась.
 - Відомий баг - ESP32 у пакеті UDP передає не більше 1460 байт. Тому, при завантаженні ефектів у додаток Котейки, деякі ефекти зникають(тільки при використанні мови з кирлицею). 
 Це пов'язано з великими розмірами файлів efflistХхх.ini, бо для кожної літери кирилиці використовуєтся 2 байти кодировки. Для вирішення цієї проблеми в ціх файлах, літери, які виглядають однаково
 з літерами латиниці, були замінени на такі (латинські) вручну. ( Це все - якщо будете змінювати назву або кількисть ефектів та використовувати файл Таблица_эффектов_all_lang_alfabet_final.xlsx ).

Версия v3.71_sound_Multilingual_IR 112 ефектов
 - Виправлено дві помилки в работі з МР3-плеєром та відображенням часу на дісплеї.

Версия v3.7_sound_Multilingual_IR 112 ефектов
 - Розширено можливості керування кількома лампами. Тепер може синхронізуватися поточна папка озвучування ефектів (включається чекбоксом на сторінці налаштування керування кількома лампами).
 І, якщо синхронізація папки увімкнена, можна синхронізувати гучність та увімкнення/вимкнення озвучування (другий чекбокс).
 - Додано автоматичне зниження яскравости єфектів в 2, 4 або 8 разив (на 50%, 75% або 87%)  у нічний час. Управлиння на головній веб сторінці.
 - Істотно перероблено деякі важливі алгоритми. Особливо алгоритми керування озвучуванням.  Виправлено дві дуже неприємні помилки та кілька дрібних помилок.

Версия v3.6_sound_Multilingual_IR 112 ефектов
 - Додано виведення поточної версії прошивки внизу на вкладці "Початкові установки".

Версия v3.5_sound_Multilingual_IR 112 ефектов
 - Додана можливість виведення рядку, що біжить, с встановленним в веб інтерфейсі інтервалом. Якщо встановлен інтервал = 0 - не буде виводитись. Якщо встановлений інтервал
 більше 60 - виводити постійно. 
 - Додана можливість встановлення лампі статичної ІР адреси. Якщо третя октета маски підмережі = 255 (в більшості випадків це так), то третя октета ІР адреси та шлюзу
 повині бути однаковими. Адресу DNS серверу змінювати тільки тоді, якщо ви гарантовано знаєте, що робите. Краще не чіпайте. 

Версия v3.45_sound_Multilingual_IR 112 ефектов
 - Видалив ефект "Рядок, що біжить". Відтепер Рядок, що біжить виводиться поверх ефектів. Вмикається режим чекбоксом у веб интерфейси на сторинки "Налаштування користувача".
 Фон тексту (простір між літерами) може бути кольоровим або чорним (чекбокс). Там же налаштовується колір тексту, та швидкисть виводу. 
 - Змінився ефект "Колір". Якщо увімкнено "Рядок, що біжить" та "Масштаб/Колір" < 3, то текст буде бігти на чорному екрани (як раніше).
 - Додано три нових ефекту: "Торнадо", "Кольоровий питон" та "Плазмові хвилі". Автори ціх ефектів @Stepko та @SlingMaster, Але всі ефекти адаптовані та модіфіковані @Alvikskor.
 - Додав кнопку виклику редактору файлової системи. Вона на сторінці "Початкові налаштування" у низу. Працює тільки при підключенні до інтернету.
 - Розширив діапазон налаштування струму матриці. Відтепер від 0 до CURRENT_LIMIT (в файлі constants.h). Максимум 9999 мА. Якщо 0 (Нуль) то струм не обмежується взагалі.
 - Виправлена помилка взаімодії декількох ламп, а також інші дрібні помилки.
 
Версия v3.41_sound_Multilingual_IR 110 ефектов
 - Переробив послідовність вимикання лампи (Зменьшив верогідність пошкодження файлів,що зберігаються при вимиканні лампи).
 - Поправив визначення лампою "день / нічь".
 - Виправив ще декілька помилок.

 Версия v3.4_sound_Multilingual_IR 110 ефектов
 - Додано три єфекти:"Краплі на воді" та "Чарівний ліхтарик" від @SlingMaster. "Восьминіг" від @Stepko але модіфікований та адаптований. Параметр "Масштаб/Колір" змінює
 кількість "ніг" та швидкість зміни кольору. Таке саме керування доробів и до єфекту "Радіальна хвиля".
 - Додано режим відновлення налаштувань за замовчуванням по п'ятнадцятикратному натисканію кнопки (навіть якщо вона заблокована). Цей рехим скидає налаштування, які зберігаються
 у файлі config.json.
 - Додано кнопку скидання налаштувань за замовчуванням в web интерфейсі на сторінки Початкових налаштувань. Але натискання на цю кнопку скидае всі налаштування, 
 включно налаштування озвучування єфектів,налаштування єфектів для Циклу, налаштування керуванням кількома лампами та параметри обладнання. (Тобто, зовсім всі налаштування).
 - Перероблено курування МР3 плеєром. Для плеєров на чіпах GD3200х з'явилася можливість налаштування озвучування часу декількома мовами. Для цьогораскоментуйте рядок у файлі constants.h
 //#define DF_PLAYER_GD3200x . Файли озвучування часу треба растошовувати у папках ADVERT1-ua, ADVERT2-en, ADVERT3-ru, ADVERT4-pl, ADVERT5-es, ADVERT6-fr.
 Зробив українську озвучку часу, але вийшло не зовсім гарно (вона є у своїй папці). Якщо у когось є озвучка іньших мов, або більш якісна українська,  будь ласка поділиться.
 Для правильноі роботи чипа GD3200x при озвучки часу встановіть час промови годин 1800, та час промови хвилин, десь 1800 - 2200. Затримку 120 -170. У мене працювало с такими цифрами.

 Версия v3.3_sound_Multilingual_IR 107 ефектов
 - З метою підвищення мережевої безпеки, пароль до WI-FI роутера вашої мережі перенесено до EEPROM. Там отримати до нього доступ із мережі значно складніше.
 У веб-інтерфейсі пароль відображається тільки під час його введення. В інших випадках поле порожнє.
 Якщо натиснути кнопку "Зберегти" при порожньому полі введення пароля, вже записаний в EEPROM пароль (якщо він був записаний туди) не зміниться.
 - Додано налаштування часу промовлення годин та хвилин. А також затримки між командами MP3 плеєру. Ці налаштування, а так само налаштування максимального
 струму, типу та орієнтації матриці винесені на окрему веб-сторінку "Hardware setings", потрапити на яку можна зі сторінки "Початкові установки" (кнопка в самому низу).
 Для оригінального чіпа час проговорення годин та хвилин у межах 1800 – 2500 мс та затримка 50 – 100 мс.
 Для не оригінального чіпа 2500 – 3500 мс та 100 – 180 мс відповідно. Ці параметри винесені для налаштування,
 тому що вони сильно залежать від швидкості роботи вашої SD-карти (флешки) і навіть кількості файлів на ній.
 Вибір чіпа DF-Player (оригінальний чи ні) у файлі constants.h як і раніше актуальний. Цей вибір впливає на інші параметри. Не нехтуйте ним.
 - Перероблено алгоритм збереження налаштувань ефектів. Налаштування зберігаються в EEPROM у таких випадках: а) при вимиканні матриці (кнопкою, пультом у додатку або веб)
 якщо не активовано режим "Цикл". б) увімкнення режиму "Цикл". в) при вимкненні за таймером, якщо не активний режим "Цикл".
 Налаштування ефектів відновлюються з EEPROM у випадках: а) під час перезавантаження лампи (увімкнення живлення). б) при включенні матриці (кнопкою, пультом у додатку або веб)
 в) у разі вимкнення режиму "Цикл". Збереження налаштувань ефектів у файл і читання їх з цього файлу як і раніше працює. Як і відновлення їх за промовчанням. (У веб-інтерфейсі відповідні кнопки)
 - Як завжди, виправлено кілька помілок.
 
 Версия v3.2_sound_Multilingual_IR 107 ефектов
  - Додано керування інфрачервоним пультом. Можливе використання двох різних пультів одночасно. Коди пультів прописуються у файлі ІR_Remote.h
  Працює автоповтор при утриманні кнопки для тих команд, де це доречно. На дисплеї відображається номер ефекту, при перемиканні ефектів,
  або значення яскравості, швидкості, масштабу, гучності, при їх зміні пультом.
  - Реструктуризована EEPROM.
  - Можливе використання бібліотеки ArduinoJson як 5-ї, так і 6-ї версій. У файлі Constants.h потрібно закоментувати та розкоментувати відповідний блок функцій.
  За замовчуванням використовується 5 версія.
  - Як завжди, виправлено кілька помілок.

 Версія FieryLedLamp_v3.00_Multilingual 107 эффектов 
  - Додано чотири ефекти: Мозайка, Феєрверк, Контакти, Радіальна хвиля.
  - Вибір мови інтерфейсу на сторінці "Початкові установки". Доступно пьять мов. Відносно легко додаті ще декилька мов, або якусь замінити.
  Якщо ви використовуєте додаток, то після зміни мови у веб-інтерфейсі , у додатку заново завантажте ефекти з лампи.
  - Можливість змінювати тип та варіанти підключення матриці на тій самій сторінці веб-інтерфейсу. Корисно для нестандартних матриць або коли не відомо, як вона повернута. 
  Підбираєте на ходу. ( так само можна прикольно урізноманітнити ефекти. Наприклад: віддзеркалити рядок, що біжить).
  - Там же можна змінювати максимальний струм матриці (максимальну яскравість) вид 100 мА до того значення, яке прописано у #define CURRENT_LIMIT у constants.h.
  - Додана можливість вмикати / вимикати промову часу будильником.
  - Додано управління автоматичним таймером вимикання лампи (Того, що запускаєтся сам автоматично, коли лампа вмикається.)
  Можліво їого встановіті на час вид 30 хвилин до 8 годин с кроком 30 хвилин, або не вимикати.
  - Виправлено кілька дрібних ( і не дуже :) помилок.

  Версія FieryLedLamp_v2.95_UKR 103 ефекта.
  - Додана можливість вибору будь-якої папки для будильника ( в налаштуваннях будильнику "Свитанок").
  - Додана можливість пидключити к DFPlayer флешку. Якщо пидключена и флешка и SD-картка, то буде грать флешка.
  Вимоги до імен файлів та папок на флешці такі ж як і для CD-карти.
  - Підтверджено роботу DFplayer на чіпі MH2024K-24SS. Але для коректної роботи потрібно у файлі constant.h закоментувати рядок #define DF_PLAYER_IS_ORIGINAL.
  Надто вже цей чіп гальмований. Тепер точно працюють чіпи плеєра AS20HGN402 (оригінальний DFPlayer-DFRobot), GB3200B та MH2024K-24SS.
  Найкласніший звук у оригінального. Найпоганіший у 24SS.
  - Віправлени знайдени помілки.

  Версія FieryLedLamp_v2.9_UKR 103 ефекта.
  - Якщо номер прив'язаної папки від 20 до 90, то програватиметься папка, вибрана випадковим чином із діапазону: вибрана папка – (вибрана папка +10).
  Тобто, якщо до ефекту прив'язали папку 30, то при кожному виборі цього ефекту папка, що програється, буде вибиратися з діапазону 30 - 39 включно  випадковим чином.
  Якщо папки з вибраним номером не існує на SD карті, то буде тиша або програватиметься папка з номером 01 (залежить від чіпа плеєра).
  - Додано управління еквалайзером і ручний вибір папки, що програється, з веб інтерфейсу
  - Додано індикацію номера ефекту та номера папки на дисплеї ТМ1637. Індикація протягом 3х секунд при зміні ефекту або/та папки (що змінилося те і показується)
  - Виправлена помилка виведення рядком, що біжить літер Ёё та україньских Її, Єє, Іі . Виправлено інші дрібні помилки. Поліпшено стабільність.

  Версія FieryLedLamp_v2.8_UKR 103 ефекта.
  - Інтерфейс перекладено Українською мовою.
  - Список ефектів форматований за абеткою. Тепер легко знайти потрібний ефект у списку при виборі.
  - Додана можливість прив'язки папки озвучування ефекту до самого ефекту у веб-інтерфейсі.

  Версия FieryLedLamp_v2.7_web_v2.5 103 эффекта 
  - Добавлены три эффекта "Мечта дизайнера", "Фейерверк" и "Цветные кудри" от SlingMaster. "Мечту" слегка подправил. Два других практически без изменений, только адаптация.
  - Исправлена ошибка плавного включения матрицы при использовании MOSFET. Вкл/Выкл сделал более плавными.
  - Исправлены другие мелкие ошибки и, вероятно, добавлены новые. :)

  Версия FieryLedLamp_v2.6_web_v2.5 100 эффектов
  - Точно работают чипы плеера AS20HGN402 (оригинальный DFPlayer-DFRobot) и GB3200B. Другие не проверял(не было), но, предполагаю, будут работать.
  - Будильник плавно увеличивает громкость от 0 до установленной. При наступлении установленного времени начинает проговаривать время каждую минуту, если включена озвучка времени 
  для этой поры суток ( день / ноч ). 
  - Папка будильника переехала с 11го номера на 99й. Наполнение папок с 1й по 99ю любое, в соответствии с треьованиями для DFPlayer. ( В GOOGLE полно инфы по этому поводу. Читайте)
  - Провод D8_ESP8266 - TX_DFPlayer переехал с D8  на D6. Связано с особенностью работы ESP8266. При подключении к D8 ESP не всегда стартует.
  - Исправлена ошибка , приводившая к мерцанию эффектов на малой яркости.
  - Если звук не нужен - закоментируйте строки #define MP3_RX_PIN (13U) и #define MP3_TX_PIN (12U) в файле constant.h и для заливки файловой системы
  используйте папку data_no_sound (Перед заливкой просто скопируйте с заменой всё содержимое этой папки в папку data).

  Версия FieryLedLamp_v2.5_web_v2.5 100 эффектов
  - Добавлен эффект "Строб.Хаос.Дифузия" от SlingMaster. Теперь общее количество эффектов 100.
  - Добавленн звук! Теперь есть звуковое сопровождение эффектов, озвучивание времени, к рассвету добавилось звуковое сопровождение. В каждом режиме громкость регулируется отдельно. 
  в веб интерфейсе. Для озвучивания времени используется разделение день/ночь. Так же, отдельно можно включить/выключить каждый режим. Громкость и вкл/выкл звучивания эффектов 
  регулируется "качелькой" телефона и кнопкой на диспле из приложения Котейки. В архиве есть папка SD_actual. Обязательными в ней являются папки 099 и ADVERT. В первую можно 
  добавлять свои файлы и использовать её для озвучивания эффектов. Но нельзя её удалять и удалять файл 000. В папке ADVERT содержатся файлы для озвучивания времени. В папке 011 
  файлы для озвучивания будильника. Наполнение этой и других папок может быть любым. На ваш вкус. Имена файлов должны начинаться с числа, соответствующего номеру файла в папке 
  (от 001 до 255). Номера папок для озвучивания эффектов задаются при проштвке лампы в файле effectTicker.ino . Если задан номер папки 0, то этот эффект озвучиваться не будет. При 
  озвучивании эффекта и будильника папка зацикливается.  Если звук не нужен - закоментируйте строки #define MP3_RX_PIN (13U) и #define MP3_TX_PIN (12U) в файле constant.h и для заливки файловой системы используйте папку 
  data_no_sound (Перед заливкой просто скопируйте с заменой всё содержимое этой папки в папку data). Точно работаeт чип плеера AS20HGN402 (оригинальный DFPlayer-DFRobot)
  - Добавлено восьмикратное нажатие на кнопку для вкл/выкл озвучивания эффектов.
  - Изменён алгоритм однократного и двухкратного нажатия на кнопку при озвучивании будильника. Если "рассвет" озвусивается, то первое однократное нажатие на кнопку выключит только зук, 
  но "рассвет" продолжится, а двухкратное нажатие в этом случае выключит и звук и "рассвет". 
  - В архиве заменена библиотека FastLed на последнюю версию. Устраняет мигание первого диода в случае использования ядра версии 3.Х.Х.
  - Исправлены найденные ошибки.

  Версия FieryLedLamp_v2.4_web_v2.2  ( gunner47_v2.4_web_v2.2_99in1 )
  - Добавлены новые эффекты от SlingMaster. Теперь общее количество эффектов 99.
  - Добавлена возможность регулировки яркости дисплея ТМ1637. Используется регулировка дневной/ночной яркости вывода времени бегущей строкой в "Настройках пользователя" веб интерфейса.
  Так как дисплей имеет 5 градаций яркости (0-4), то яркость дисплея вычисляется как дневная/ночная яркость делённая на 51. 0 - дисплей выключен. 
  - Добавлена в веб интерфейсе регулировка максимальной яркости будильника "Рассвет".
  - Для разработчиков приложений. Добавлены команды ssid, password, esp_mode=0, esp_mode=1. Если вместо команды GET-ВРЕМЯ использовать GET ВРЕМЯ (вместо тире пробел)
  то лампа будет отвечать NEWCURR с дополнительными данными. Для подробностей смотрим функцию void NEWsendCurrent(char *outputBuffer).  Теперь есть возможность доработать приложение,
  чтобы пользователь мог прямо из приложения задать логин и пароль своей сети, а так же изменить режим лампы. В GVR Lamp это уже реализовано. А так же добавить новые функции (и поправить старые :) ).
  - Для тех, кто активно пользуется настройкой параметров эффектов и сохранением их файл, теперь появилась возможность перенести их в новую версию
  прошивки. Подробности под спойлером на моей страничке описания прошивки.
  https://community.alexgyver.ru/threads/wifi-lampa-budilnik-obsuzhdenie-proshivki-ot-gunner47.2418/page-205#post-73929 
  - Доведена до ума работа дисплея ТМ1637, чтобы ничего не тормозило, не вылетало и адекватно реагировало на все именения режимов.
  Исправлены другие найденные ошибки и косяки в работе прошивки.
  
  Версия FieryLedLamp_v2.31_web_v2.2  ( gunner47_v2.31_web_v2.2_94in1 )
  - Добавлена функция однократного вывода своего IP адреса лампой при подаче питания или рестарте. По умолчанию применена для ламп без кнопки.
  Но в файле constant.h перед прошивкой можно включить её и для ламп с кнопкой (или выключить для ламп без кнопки).
  - Добавлен вывод времени на дисплей ТМ1637. По умолчанию выключен. Включить и изменить порты для подключения дисплея можно в файле constant.h .  
  - Исправлена ошибка пропадания кнопки "Получение времени из браузера" при включении защиты паролем страницы "Начальные настройки".
  
  Версия FieryLedLamp_v2.3_web_v2.2  ( gunner47_v2.3_web_v2.2_94in1 )
  - Добавлена синхронизация времени одной кнопкой на странице "Начальные установки" в веб интерфейсе с веб браузером на управляющем устройстве (например, телефоне).
  - Добавлен альтернативный дизайн главной страницы веб интерфейса (по просьбам пользователей). Переключение чекбоксом в самом низу главной страницы.
  - Исправлена ошибка , приводившая к полному нарушению работоспособности физической кнопки.
  - Исправлена работа кнопки запуска таймера включения/выключения лампы. 
  - Автором исправлены ошибки в эффектах "Свеча" и "Украина". В эффект "Украина" добавлена регулировка масштабом времени рестарта.
  - В архив прошивки добавлена краткая инструкция пользователя.  
  
  Версия FieryLedLamp_v2.2_web_v2.1  ( gunner47_v2.2_web_v2.1_94in1 )
  - Добавлены новые эффекты от Сотнега и SlingMastera.
  - Добавлены кнопки сохранения настроек эффектов в файл и чтения их из файла. Фойл сохраняется в ФС лампы. Так что, если долго настраивали
    любимые еффекты, сохраните эти настройки, и всегда сможете к ним вернуться.
  - Добавлено синхронное управление несколькими (до 4) лампами. В отличии от управления через приложение, сдесь не нужно выбирать главную лампу.
    Если во сех лампах прописаны (через web интерфейс) IP адреса соседних ламп, то вы можете управлять любой из ламп приложением, кнопкой или
    через web интерфейс. Все ваши действия будут синхронно отображаться на соседних лампах. Если включить режим Цикл на одной из ламп, то все 
    лампы будут синхронно переключаться вместе с лампой, на которой выбран режим Цикл. Можно, кстати, его включить и на нескольких лампах,
    например с разным временем переключения или с перемешиванием эффектов. Разумеется, желательно (но не обязательно), чтобы набор и
    последовательность эффектов в лампах были одинаковыми (для синхронности).  Пробуйте.

  Версия FieryLedLamp_v2.15_web_v2.0  ( gunner47_v2.15_web_v2.0_88in1 )
  - Добавлено полноценное управление режимом "Цикл".
  - Добавлена регулировка общей яркости эффектов на странице выбора эффектов для цикла.
  - Добавлен чекбокс перемешивать выбранные эффекты в Цикле или воспроизводить по порядку.
  - Добавлены кнопки "Настройки текущего эффекта" "По умолчанию" и "Случайные" Влияет только на эффект , воспроизводящийся в ткущий момент. 
    ( В Настройках пользователя есть чекбокс "Случайный выбор настроек эффектов". Он влияет на все эффекты, Как и кнопка под ним "Cброс настроек эффектов в исходные").
  - Добавлен эффект"Свеча". На плоской матрице смотрится хорошо, На круглой  - только с фасада.
  - Слегка оптимизирован дизайн web страниц интерфейса.

  Версия FieryLedLamp_v2.14_web_v1.7  ( gunner47_v2.14_web_v1.7_87in1 )
  - Добавлен таймер отключения по кнопке лампы. По 4-х кратному (один раз) нажатию таймер устанавливается на 5 минут. По 4-х кратному нажатию с удержанием таймер устанавливается на 10 минут. 
    Если лампа была выключена, она включится. ( 4-х кратное нажатие два раза с интервалом не более 7 секунд, по прежнему осталось АрдуиноОТА обновление.).
  - Добавлена возможность устанавливать время свечения лампы после "Рассвета" от 0 до 99 минут.
  - Исправлены несколько досадных ошибок будильника.
 
  Версия FieryLedLamp_v2.12_web_v1.7  ( gunner47_v2.12_web_v1.7_87in1 )
  - Добавлено полноценное управление будильником "Рассвет".
  - Починен эффект "Бегущая строка" . Можно задавать текст до 42 символов не зависимо от языка ввода..
  - Добавлены кнопки пошаговой (точной :)) настройки значений яркости, скорости и масштаба / цвета.
  - Решены проблемы с регулляторами при переходе между эффектами.

  Версия FieryLedLamp_v2.12_web_v1.6  ( gunner47_v2.12_web_v1.6_87in1 )
  - Добавлено три новых эффекта Пламя, Огонь2021 и Вино. Три имевшихся Пикассо объёденены в один.
  - Добавлена Тёмная тема для web интерфейсаи возможность переключения между темами. По умолчанию - тёмная тема.
  - Добавлена возможность страницу "Начальные Установки" защитить паролем от детей и посторонних любопытных глаз (там пароль Вашей WiFi сети и другое).  Используется пароль точки доступа, поэтому его рекомендуется сменить !!!
  - Добавлены полноценное управдение эффектами в web интерфейсе (кроме управления будильником и режимом цикл).
  - Оптимизирована работа будильника "Рассвет". Добавлена защита от переполнения millis().
  - Известные проблемы: при переходе между эффектами для актуализации значений и положения регуляторов нужно обновить страницу в браузере. 
    Будет решено в следующих версиях

  Версия FieryLamp_v2.12_web_v1.5  ( gunner47_v2.12_web_v1.5_86in1 )
  - Добавлена возможность ввода текста для бегущей строки с сохранением его по умолчанию, настройка режимов вывода времени бегущей строкой на выключенной лампе, Вкл/Выкл автоотключения через 5 часов (если, например ,забыли выключитьуходя из дома).
  - Лампа может автоматически возобновлять показ эффектов при подаче питания, если до пропадания питания она была включена. Добавлено включение / выключение этого режима.
  - Добавлена возможность смены  NTP сервера (сервер часов)

  Версия FieryLamp_v2.11_web_v1.3  ( gunner47_v2.11_web_v1.3_86in1 )
  - Добавлена кнопка включения / выключения лампы в web интерфейс.
  - Исправлена работа сенсорной кнопки лампы.

  Версия 2.1_beta_86in1  ( gunner47_v2.1_web_v1.3_86in1 ) 
  - Добавлен web updater. Теперь можно загружать прошивку по ОТА через любой браузер из bin файла. Нет необходимости устанавливать Arduino IDE. Удобно для поддержки конечных польэователей.
  - Добавлен web интерфейс для настройки  лампы. Можно менять имя лампы, имя и пароль точки доступа, имя и пароль WiFi сети, часовой пояс и переход на летнее время, а так же управлять режимами Random, переход Кнопкой-только по выбранным эффектам или по всем, Вкл/Выкл сенсорной кнопки лампы, управление выводом времени бегущей строкой.
  - Теперь лампу можно включить примерно через секунду после подачи питания не дожидаясь подключения к WIFi сети.
  - Исправлены мелкие ошибки.

  Версия 2.86 эффектов в 1
  - Если удерживать кнопку на выключенной лампе, включится сразу режим "Белый свет".
  - Если включился режим "Белый свет" (не важно, каким способом) и при этом данный режим не добавлен в список для автоматического переключения эффектов, тогда он сам не переключится.
  - Можно сделать, чтобы кнопкой переключались только те режимы, которые добавлены в избранное для режима Цикл. Настройка #define BUTTON_CHANGE_FAVORITES_MODES_ONLY
  - Лампа будет пытаться соединиться с роутером целых 60 секунд, а не 7, как раньше было. Это чтобы лампа могла дождаться загрузки роутера, если электричество в доме отключалось. Настройка #define ESP_CONN_TIMEOUT (60U)
  - Лампа будет проверять появление на роутере интернета через каждые 15 секунд, а не раз в 5 минут, как раньше было. Это чтобы время в лампе поскорее синхронизировалось с NTP-сервером. Настройка #define RESOLVE_INTERVAL (15UL * 1000UL)
  - Лампа будет забывать пароль к роутеру, если её переключили в режим работы "без роутера" кнопкой или по истечении 60 секунд ожидания. Это чтобы приложение не теряло связь с лампой в режиме "без роутера". Настройка #define RESET_WIFI_ON_ESP_MODE_CHANGE
  - Прошивку не удастся загрузить, если актуальные библиотеки из архива с прошивкой не положены в папку с библиотеками.
  - Лампа не будет реагировать на "фантомные нажатия" сенсорной кнопки, если вы забыли её подключить перед включением лампы в розетку. Настройка #define BUTTON_LOCK_ON_START
  - Убран в отдельную настройку сигнал лампы "про проблему со временем" во время работы эффектов. По умолчанию мигать двумя светодиодами во время работы эффектов лампа не будет.  
  - В режиме Цикл эффекты теперь запускаются на случайных, но удачных настройках. Можно это отключить, если не требуется.
  - Добавлены эффекты Цветные драже, Плазменная лампа, Северное сияние, Шары, Магма.
  - Удалён эффект Блуждающий кубик (версию прошивки повышаем, теперь больше нет оправданий, что этот эффект должен быть вместе со всеми 26ю изначальными).
  - Собраны воедино надоевшие эффекты Радуга вертикальная+горизонтальная+диагональная, Звездопад+Метель.
  - Убран запрет на установку времени ожидания подключения к роутеру более 7 секунл (для этого нужно брать библиотеки из архива с прошивкой).
  - В эффекте Белый свет добавлен вертикальный вариант ("направленный свет") для бегунка Масштаб от 50 и выше.
  - Исправлен режим Часы для узких матриц от 11 до 14 пикселей в высоту (не работал).
  - Появилась поддержка команд "RND_" от приложения для управления режимом случайных настроек и возврату к настройкам по умолчанию (а приложение такое пока ещё не появилось).
  
  Версия 1.5.85 эффектов в 1
  - Добавлены эффекты Фея, Источник.
  - Удалён эффект Мячики со шлейфом (это была просто копия Мячиков для демонстрации на других настройках бегунка Скорость).
  - Добавлена возможность автоматической синхронизации времени лампы со смартфоном. Приложение должно поддерживать данную функцию.
  - Добавлена индикация о том, что лампа не знает время (если по низу лампы по кругу бегут 2 цветные точки, значит, не знает).
  - Исправлен баг в библиотеке FastLed в реализации функции blur2d. Рекомендуется положить библиотеки из архива с прошивкой в папку библиотек программы Arduino IDE.
  - Убран запрет поиска ip-адреса лампы, когда лампа работает в виде точки доступа без роутера (в режиме ESP_MODE = 0).
  - Добавлена возможность передать приложению имя лампы (на случай, когда у вас в домашней сети несколько ламп). Приложение должно поддерживать данную функцию.
  
  Версия 1.5.84 эффекта в 1
  - Добавлены эффекты Кипение, Притяжение, Капли на стекле, Дымовые шашки, Тихий океан, Nexus.
  - Убраны эффекты Белый огонь, Цветной огонь, Бeлый вoдoпaд, Быстрый пульс, Пульсирующая кoмeтa (копии и похожие эффекты уже не интересны даже в режиме Цикл, и так эффектов многовато).
  - Убран запрет обновления прошивки "по воздуху", когда лампа работает в виде точки доступа без роутера (в режиме ESP_MODE = 0).
  - Исправления в эффектах ДНК (добавлено управление бегунком Масштаб), Мячики без границ, Вихри, Разноцветные вихри, Стая, Стая и хищник (сглаживание).

  Версия 1.5.83 эффекта в 1
  - Добавлен эффект Огонь 2020.
  - Возвращён эффект Пульсирующая комета.
  - Устранены проблемы "хищник умер", "время бегущей строкой дёргается".
  - Убрано затухание лампы в момент смены эффектов. Убрана предварительная очистка изображения предыдущего эффекта, где было возможно.
  - Добавлены "секретные команды" для установки Будильника Рассвет и Таймера выключения из приложения Blynk (вдруг кому очень надо).

  Версия 1.5.81 эффект в 1
  - Удалён эффект Белая комета.
  - Временно удалён эффект Пульсирующая комета.
  - Временно? добавлен эффект Осциллятор.
  - Обновлена поддержка приложения Blynk для управления текстом бегущей строки и передачи "секретных команд".
  - Эффекты Дым лучше адаптированы для ламп с плохим рассеивателем.
  - Найдена и убрана причина того, что в режиме Цикл лампа полностью гасла между эффектами.
  
  Версия 1.5.82 эффекта в 1
  - Удалён эффект Салют.
  - Добавлены эффекты Жидкая лампа и эффект Попкорн.
  - Реализована возможность установки времени на лампе без подключения к интернету (через приложение для Андроид от @Koteyka - оно есть в архиве с прошивкой).
  - Добавлена поддержка секретных команд reset=wifi, reset=effects, esp_mode=.. (через приложение для Андроид от @Koteyka - оно есть в архиве с прошивкой).
  
  Версия 1.5.80 эффектов в 1
  - В эффекте Цвет добавлена возможность выбора насыщенности бегунком Скорость.
  - Добавлены эффекты Тени, Мотыльки, Лампа с мотыльками, ДНК, Змейки, Салют.
  - Добавлена поддержка приложения Blynk (для iOS и Android) для ламп, имеющих постоянный доступ в Интернет. Если включить, будет всё немного подтормаживать.
  
  Версия 1.5.74 эффекта в 1
  - Добавлен эффект Лавовая лампа.
  
  Версия 1.5.73 эффекта в 1
  - Добавлены эффекты Пикассо.
  - Добавлен эффект Прыгуны.
  
  Версия 1.5.69 эффектов в 1 proper
  - В эффекте Белый свет сделано более плавное изменение площади свечения бегунком Масштаб (может, и зря).
  - В эффекте Метаболз наконец-то исправлена проблема перезагрузки лампы при длительной работе.

  Версия 1.5.69 эффектов в 1
  - Добавлены эффекты Дым и Разноцветный дым.

  Версия 1.5.67 эффектов в 1
  - Добавлен отдельный режим Часы. Просто как обычный предпоследний эффект. "Скорость" регулирует местоположение цифр. Чем лучше рассеивание на лампе, тем бесполезнее этот режим.
    Минимальная необходимая для Часов высота матрицы 11 пикселей. И 7 пикселей по ширине должно быть видно на одной стороне лампы, иначе часть циферблата уползёт на бок.
  - Исправлены баги в эффектах Кометы, вызывающие перезагрузку лампы при отличающихся друг от друга высоте и ширине матрицы, и при матрице высотой менее 14 пикселей.

  Версия 1.5.66 эффектов в 1
  - Все сложные настройки в Constants.h убраны вниз, чтобы не отвлекали.
  - Добавлены эффекты Мячики без границ (Прыжки), Кодовый замок и Кубик Рубика. Скрыт эффект Белые мячики (можно выбрать белый цвет обычным).
  - Добавлена возможность установить автоматическое выключение лампы после нескольких часов непрерывной работы (на случай, если кто-то забыл её выключить). 
    В приложении время выключения будет отображаться неверно, пока не исправят в будущих версиях.

  Версия 1.5.64 эффекта в 1
  - Добавлен эффект Мерцание.
  - Эффект Смена цвета теперь работает медленнее. На масштабах >10 переключение цвета будет через выбранное количество секунд (1 секунда для Скорости = 255 / 2 секунды для Скорости = 254 и т.д.)
  - В эффекте Метаболз добавлена возможность выбора палитры бегунком Масштаб
  - Обновлены эффекты Метель и Звездопад на версию от @Palpalych.
  - Добавлена возможность включить "очередь показов" выбранных эффектов для режима Цикл (чтобы не было повторов слишком часто). Это нужно включать в Constants.h.
  - Добавлена возможность выключить функцию "продолжить демонстрацию последнего эффекта после обесточивания лампы". Это нужно делать в Constants.h.
  - Исправлена размерность переменной currentMode. Возможно, теперь максимальное количество эффектов может быть больше 127 штук. Но это не точно.
  
  Версия 1.5.63 эффекта в 1
  - Добавлены эффекты Тучка в банке, Гроза в банке, Осадки, Огонь 2012.
  - Добавлена регулировка оттенка у эффекта Огонь 2018.
  - В Constants.h добавлен параметр для поддержки более свежей версии приложения от @Koteyka.
  - Оптимизированы функции parsing.h
  - Исправлена функция XY(). Это был аналог getPixelNumber(), но почему-то криво написанный.

  Версия 1.5.60 эффектов в 1
  - Добавлен эффект Огонь 2018.
  - Добавлена регулировка Масштаба у эффектов 2 кометы, 3 кометы, Парящий огонь, Верховой огонь.
  - Возможно, исправлена совместимость прошивки с матрицами, где способ подключения светодиодов отличается от "змейки".

  Версия 1.5.59 эффектов в 1
  - Создан массив настроек всех эффектов по умолчанию. Настройки выбраны с небольшой яркостью для работы в режиме ночника (для себя делал). Можете поставить яркость побольше.
  - Добавлен сброс настроек всех эффектов на значения по умолчанию при поступлении запроса от приложения ("загрузить список эффектов из лампы"). Можно отключить это в Constants.h.
  - Добавлены эффекты Вихри пламени и Разноцветные вихри.
  - В эффекте Светлячки со шлейфом теперь можно выбрать им цвета бегунком Масштаб.

  Версия 1.5.57 эффектов в 1
  - Объединено использование многих переменных в разных эффектах для небольшой экономии памяти.
  - Эффект Цвет тоже вынесен наверх в эффекты с принудительной задержкой в 50 мс, чтобы не травмировать контроллер платы.
  - Добавлены эффекты Стая, Стая и хищник, Призмата, Волны.
  - Увеличен размер буфера для приёма настроек Избранного от приложения в лампу. Теперь максимальное количество эффектов где-то в районе 117.
    (но это уже предел для текущей реализации функций FavoritesManager.h. дальше придётся менять там типы переменных).
  
  Версия 1.5.53 эффекта в 1
  - Изменён способ отправки списка эффектов в лампу. Теперь он не ограничен размером буфера, а ограничен хз чем.
  - Список эффектов расширен до 53 штук.
  - Добавлены новые функции, поддерживаемые приложением от @Koteyka (рисование, бегущая строка).
  
  Версия 1.5: 
    этот же список с гиперссылками: https://community.alexgyver.ru/threads/wifi-lampa-budilnik-obsuzhdenie-proshivki-ot-gunner47.2418/post-30883
  - Исправлен баг в условии процедуры вызова эффектов (у двух эффектов регулятор скорость не работал)
  - Инвертирована регулировка Скорости у всех эффектов, где она работала задом наперёд
  - Из всех эффектов убраны обращения к их порядковым номерам. Теперь любой эффект можно устанавливать на любое место (кроме номеров с 7 по 15), а также делать копии эффектов
  - Переработано распределение флеш-памяти EepromManager.h Теперь можно добавлять новые эффекты и делать копии (копии - для демонстрации одного эффекта на разных настройках).
  - В библиотеке FastLED исправлены коэффициенты расчёта потребления тока
  - Эффект Огонь заменён на "Ламповый огонь", при максимальном Масштабе он же будет эффект Белый огонь
  - Эффект Белый огонь заменён на эффект Водопад, при максимальном Масштабе цвет воды будет белым
  - Внесены исправления эффектов Пейнтбол и Радуга диагональная от @Palpalych (выставляйте Пейнтболу Скорость побольше, чтобы выглядело хорошо)
  - К эффекту Цвет добавлен эффект Бассейн (при максимальной Скорости блики воды исчезают, работает эффект Цвет)
  - К эффекту Смена цвета добавлен эффект Пульс (при минимальном Масштабе будет работать эффект Смена цвета)
  - Внесены исправления эффектов Метель и Звездопад от @Rampart
  - У эффекта Матрица изменена цветовая палитра и алгоритм работы (Нестыдная Матрица)
  - Эффект Светлячки со шлейфом заменён на эффект Кометы (в коде оставлены старый эффект, а также дополнительный Кометы мини, но они не подключены)
  - С прошивкой в архиве поставляется 2 приложения. Стандартное может работать только с 26 эффектами. При увеличении количества эффектов будет работать только приложение от @Koteyka
  - В архив с прошивкой добавлен файл с инструкцией в формате книжки. Правда, там уже устарели все ссылки.
  - Добавлен обработчик команды "GBR" для изменения яркости всех эффектов сразу без сохранения в энергонезависимую память. Приложение должно поддерживать данную функцию.
  - Добавлен обработчик команды "LIST" для отправки в приложение количества и реестра установленных эффектов. Приложение должно поддерживать данную функцию.

  Версия 1.4:
  - Исправлен баг при смене режимов
  - Исправлены тормоза в режиме точки доступа
  --- 08.07.2019
  - Исправлены параметры и процесс подключения к WiFi сети (таймаут 7 секунд) и развёртываия WiFi точки доступа (параметры имени/пароля)
  - Добавлено "#define USE_NTP" - позволяет запретить обращаться в интернет
  - Добавлено "#define ESP_USE_BUTTON - позволяет собирать лампу без физической кнопки, иначе яркость эффектов самопроизвольно растёт до максимальной
  - Переработаны параметры IP адресов, STA_STATIC_IP теперь пустой по умолчанию - избавляет от путаницы с IP адресами из неправильных диапазонов
  - Добавлено "#define GENERAL_DEBUG" - выводит в Serial/Telnet некоторые отладочные сообщения
  - Добавлено "#define WIFIMAN_DEBUG (true)" - выводит в Serial/Telnet отладочные сообщения библиотеки WiFiManager
  - Добавлена таблица с тест кейсами
  - Форматирование кода, комментарии
  --- 11.07.2019
  - Исправлена ошибка невыключения матрицы после срабатывания будильника, если до будильника матрица была выключенной
  - Дополнена таблица с тест кейсами
  --- 14.07.2019
  - Исправлена ошибка выключения будильника, если перед его срабатыванием был активен эффект "матрица" (или другой эффект, где задействовано мало светодиодов)
  - Добавлено управление по воздуху:
  -- работает только в режиме WiFi клиента
  -- работает при подключенной кнопке (потому что режим прошивки активируется кнопкой)
  --- 16.07.2019
  - Исправлено регулярное подвисание матрицы на 1-2 секунды при отсутствии подключения к интернету (но при успешном подключении к WiFi)
  --- 28.07.2019
  - Доработано взаимодействие с android приложением (отправка состояния после каждой операции)
  --- 01.08.2019
  - Возврат к стандартной библиотеке GyverButton (изменениё из неё перенесено в button.ino
  - Добавлены 2 эффекта: Светлячки со шлейфом и Белый свет
  - При запросе обновления по воздуху (2 четверных касания к кнопке) лампа переключается в режим "Матрица" для визуального подтверждения готовности к прошивке
  - В android приложение добавлена функция сканирования сети и добавления ламп с помощью multicast пакетов, доработка прошивки под это
  --- 03.08.2019
  - Исправлены ошибки взаимодействия android приложения с лампой, в вывод команды CURR добавлено текущее время (или millis(), если время не синхронизировано)
  --- 10.08.2019
  - Добавлена точная настройка яркости, скорости и масштаба эффектов
  - Добавлено взаимодействие с android приложением по управлению будильниками
  --- 14.08.2019
  - Добавлена функция таймера отключения
  --- 26.08.2019
  - Добавлен режим автоматического переключения избранных эффектов
  - Реорганизован код, исправлены ошибки
  --- 28.08.2019
  - Добавлен вызов режима обновления модуля esp из android приложения
  --- 30.08.2019
  - Эффект "Светлячки со шлейфами" переименован в "Угасающие пиксели"
  - Добавлены 5 новых эффекта: "Радуга диагональная", "Метель", "Звездопад", "Светлячки со шлейфами" (новый) и "Блуждающий кубик"
  - Исправлены ошибки
  --- 04.09.2019
  - Большая часть определений (констант) перенесена в файл Constants.h
  - Большая оптимизация использования памяти
  - Исправлена ошибка невключения эффекта "Белый свет" приложением и кнопкой
  - Исправлена ошибка неправильного выбора интервала в режиме Избранное в android приложении
  --- 16.09.2019
  - Добавлено сохранение состояния (вкл/выкл) лампы в EEPROM память
  - Добавлен новый эффект белого света (с горизонтальной полосой)
  - Реорганизован код, исправлены ошибки
  --- 20.09.2019
  - Добавлена возможность сохранять состояние (вкл/выкл) режима "Избранное"; не сбрасывается выключением матрицы, не сбрасывается перезапуском модуля esp
  - Убрана очистка параметров WiFi при старте с зажатой кнопкой; регулируется директивой ESP_RESET_ON_START, которая определена как false по умолчанию
  --- 24.09.2019
  - Добавлены изменения из прошивка от Alex Gyver v1.5: бегущая строка с IP адресом лампы по пятикратному клику на кнопку
  --- 29.09.2019
  - Добавлена опция вывода отладочных сообщений по пртоколу telnet вместо serial для удалённой отладки
  - Исправлена ошибка регулировки яркости кнопкой
  --- 05.10.2019
  - Добавлено управление по протоколу MQTT
  - Исправлена ошибка выключения будильника кнопкой
  - Добавлена задержка в 1 секунду сразу после старта, в течение которой нужно нажать кнопку, чтобы очистить сохранённые параметры WiFi (если ESP_RESET_ON_START == true)
  --- 12.10.2019
  - Добавлена возможность сменить рабочий режим лампы (ESP_MODE) без необходимости перепрошивки; вызывается по семикратному клику по кнопке при включенной матрице; сохраняется в EEPROM
  - Изменён алгоритм работы будильника:
  -  * обновление его оттенка/яркости происходит 1 раз в 3 секунды вместо 1 раза в минуту
  -  * диоды разбиты на 6 групп, первой из которых назначается новый оттенок/яркость 1 раз в 3 секунды, вторая "отстаёт" на 1 шаг, третья - на 2 шага и т.д. (для большей плавности)
  - Добавлена визуальная сигнализация о некоторых важных действиях/состояниях лампы:
  -  * при запуске в режиме WiFi клиента и ещё не настроенных параметрах WiFi сети (когда их нужно ввести)                                                     - 1 вспышка жёлтым
  -  * если лампа стартовала в режиме WiFi клиента с ненастроенными параметрами WiFi сети, и они не были введены за отведённый таймаут (перед перезагрузкой)   - 1 вспышка красным
  -  * при переходе лампы в режим обновления по воздуху (OTA) по двум четырёхкратным кликам по кнопке или по кнопке OTA из android приложения                  - 2 вспышки жёлтым
  -  * если лампа была переведена в режим OTA, но не дождалась прошивки за отведённый таймаут (перед перезагрузкой)                                            - 2 вспышки красным
  -  * при переключении рабочего режима лампы WiFi точка доступа/WiFi клиент семикратным кликом по кнопке (перед перезагрузкой)                                - 3 вспышки красным
  -  * при запросе вывода времени бегущей строкой, если время не синхронизировано                                                                              - 4 вспышки красным
  - Уменьшен таймаут подключения к WiFi сети до 6 секунд; вызвано увеличившейся продолжительностью работы функции setup(), она в сумме должна быть меньше 8 секунд
  - Оптимизирован код
  --- 14.10.2019
  - Если при первом старте в режиме WiFi клиента запрашиваемые имя и пароль WiFi сети не введены за отведённый таймаут (5 минут), лампа перезагрузится в режиме точки доступа
  - Добавлен вывод времени бегущей строкой:
  -  * по запросу - шестикратному клику - текущее время белым цветом;
  -  * периодически - определяется константой PRINT_TIME в Constants.h - от раза в час (красным цветом) до раза в минуту (синим цветом) с яркостью текущего эффекта как при включенной, так и при выключенной матрице
  --- 19.10.2019
  - Добавлены "ночные часы" (от NIGHT_HOURS_START до NIGHT_HOURS_STOP включительно) и "дневные часы" (всё остальное время), для которых доступна регулировка яркости для вывода времени бегущей строкой - NIGHT_HOURS_BRIGHTNESS и DAY_HOURS_BRIGHTNESS
  --- 20.10.2019
  - Добавлена блокировка кнопки на лампе из android приложения; сохраняется в EEPROM память
  --- 24.10.2019
  - Добавлен вывод сигнала (HIGH/LOW - настраивается константой MOSFET_LEVEL) синхронно с включением матрицы на пин MOSFET транзистора (настраивается константой MOSFET_PIN)
  - Добавлен вывод сигнала (HIGH/LOW - настраивается константой ALARM_LEVEL) на пин будильника (настраивается константой ALARM_PIN); сигнал подаётся в течение одной минуты, начиная со времени, на которое заведён будильник
  --- 02.11.2019
  - Добавлен переход на летнее/зимнее время (изменены настройки часового пояса, см. Constants.h); добавлена библиотека Timezone
  - Добавлен эффект Белый огонь
  - Исправлена ошибка сброса сигнала на пине ALARM_PIN при отключении будильника вручную
  - Добавлена сигнализация (4 вспышки красным) при запросе вывода времени шестикратным кликом, если время не синхронизировано
  --- 04.11.2019
  - Исправлена ошибка невключения MOSFET'а матрицы при срабатывании "рассвета"
  - Исправлена ошибка невключения MOSFET'а матрицы при выводе времени и IP адреса
  --- 08.11.2019
  - Исправлены ошибки назначения статического IP адреса
  - Добавлен набросок WiFiManager Captive Portal для ввода пользовательских параметров и настроек
